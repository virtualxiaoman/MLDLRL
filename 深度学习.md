# 1. shape

简表：

|名称|`nn.`|输入参数|输入shape|输出shape|
|:---:|:---:|:---:|:---:|:---:|
|[激活函数](https://pytorch.org/docs/stable/generated/torch.nn.ReLU.html)|`Relu`、`Softmax`|\ |*|*|
|[展平层](https://pytorch.org/docs/stable/generated/torch.nn.Flatten.html)|`Flatten`|[start_dim=1, end_dim=-1]|[batch_size, *]|[batch_size, $\prod *$]|
|[线性层](https://pytorch.org/docs/stable/generated/torch.nn.Linear.html)|`Linear`|in_features, out_features|[*, in_features]|[*, out_features]|
|[互相关](https://pytorch.org/docs/stable/generated/torch.nn.Conv2d)|`Conv2d`|in_channels, out_channels, kernel_size|[$N$, in_channels, $h$, w]|[$N$, out_channels, $h_{out}$, $w_{out}$]|
|[汇聚层](https://pytorch.org/docs/stable/generated/torch.nn.MaxPool2d.html)|`Pool2d`|kernel_size|[$N$, $C$, $h$, $w$]|[$N$, $C$, $h_{out}$, $w_{out}$]|
|[归一化](https://pytorch.org/docs/stable/generated/torch.nn.BatchNorm2d)|`BatchNorm2d`|channels|[$N$, $C$, $H$, $W$]|[$N$, $C$, $H$, $W$]|

**表的一些约定**：
- 对于一个名称，如果存在多个对应链接，一般取最常用的那个。
- 维度变量的表示：一般输入维度都是[batch_size, channels, height, width]，偶尔使用in_前缀来区分前后的维度名称，也会使用[$N$, $C$, $H$, $W$]，[$N$, $C$, $h$, $w$]等简化表示。
- 符号：*代表代表任意数量的维度，输入参数里的[]用于表示可选参数。
- 计算：限于表格大小，公式在上文给出，表格内只给出大致流程。

- 还没填到表里的：深度可分离卷积、膨胀卷积


# 2. 激活函数

# 3. 损失函数

一般使用$L$是我简化后的表达式，使用$\ell$是pytorch官方的表达式。

1. [CrossEntropyLoss](https://pytorch.org/docs/stable/generated/torch.nn.CrossEntropyLoss.html)
$$ L = -\text{ln} \frac {e^{x_{target}}} {\sum_{c \in C} e^{x_c}} $$
$$ \ell(x,y)=L=\{l_1,\ldots,l_N\}^\top,\quad l_n=-w_{y_n}\log\frac{\exp(x_{n,y_n})}{\sum_{c=1}^C\exp(x_{n,c})}\cdot1\{y_n\neq\text{ignore}_\text{index}\} $$

```python
y = torch.LongTensor([0])
z = torch.Tensor([[0.2, 0.1, -0.1]])
criterion = torch.nn.CrossEntropyLoss()
loss = criterion(z, y)
print(loss)  # tensor(0.9729)
p = torch.exp(z[0, y]) / torch.sum(torch.exp(z[0]))  # tensor([0.3780])
loss = -math.log(p.item())
print(loss)  # 0.9729189784937841
```

# 4. 优化器

# 5. 正则化

# 6. 批标准化

# 7. Net

## 7.1 AlexNet

## 7.2 VGG

## 7.3 GoogLeNet

## 7.4 ResNet

## 7.5 DenseNet

## 7.6 SENet

## 7.7 UNet
<div align=center>
    <img src="assets/深度学习/images/image.png" width="80%">
</div>

